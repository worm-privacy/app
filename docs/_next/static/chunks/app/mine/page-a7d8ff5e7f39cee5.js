(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[933],{6270:function(e,t,n){Promise.resolve().then(n.bind(n,4364))},4364:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return el}});var r=n(7437),a=n(6900),s=n(6070),o=n(2869),l=n(2660),i=n(9322),c=n(1804),d=n(7168),m=n(6399),u=n(9232),g=n(5805),p=n(7414),h=n(7648),x=n(2926),f=n(6366),b=n(3649),v=n(2794),y=n(2265),w=n(6110),N=n(5186),j=n(6815),E=n(3618),S=n(5684);function C(e){let{children:t,bethBalance:n,currentEpoch:a}=e,[s,l]=(0,y.useState)(!1),[c,d]=(0,y.useState)(""),[m,u]=(0,y.useState)(""),[g,p]=(0,y.useState)(!1),[h,x]=(0,y.useState)(null),[b,v]=(0,y.useState)(!1),[C,k]=(0,y.useState)(!1),{address:F}=(0,S.K)(),{networkConfig:B}=(0,f.L)(),{readContract:T,writeContract:A}=(0,S.c)(B.contracts.worm,[{name:"approximate",type:"function",stateMutability:"view",inputs:[{name:"_amountPerEpoch",type:"uint256"},{name:"_numEpochs",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{name:"participate",type:"function",stateMutability:"nonpayable",inputs:[{name:"_amountPerEpoch",type:"uint256"},{name:"_numEpochs",type:"uint256"}],outputs:[]}]),{readContract:_,writeContract:I}=(0,S.c)(B.contracts.beth,[{name:"allowance",type:"function",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{name:"",type:"uint256"}]},{name:"approve",type:"function",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{name:"balanceOf",type:"function",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{name:"",type:"uint256"}]},{name:"name",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"string"}]},{name:"symbol",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"string"}]},{name:"decimals",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"uint8"}]},{name:"totalSupply",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"uint256"}]}]),M=(Number.parseFloat(c)||0)*(Number.parseFloat(m)||0),O=M<=(Number.parseFloat(n)||0),R=c&&m&&Number.parseFloat(c)>0&&Number.parseFloat(m)>0;(0,y.useEffect)(()=>{let e=new AbortController;return(async()=>{if(c&&m&&Number.parseFloat(c)>0&&Number.parseFloat(m)>0&&F&&B.contracts.worm)try{if(e.signal.aborted)return;console.log("[v0] Calling approximate with:",{amountPerEpoch:Math.floor(1e18*(Number.parseFloat(m)||0)),numEpochs:Number.parseInt(c)||0,contractAddress:B.contracts.worm,userAddress:F});let t=await T("approximate",[BigInt(Math.floor(1e18*(Number.parseFloat(m)||0))),BigInt(Number.parseInt(c)||0)]);if(e.signal.aborted)return;console.log("[v0] Approximate result:",t),x(t)}catch(n){var t;(null==n?void 0:n.code)==="NETWORK_ERROR"&&(null==n?void 0:null===(t=n.message)||void 0===t?void 0:t.includes("network changed"))||console.error("[v0] Error fetching approximate WORM amount:",n),e.signal.aborted||x(null)}else console.log("[v0] Not fetching amount - conditions not met:",{isValid:!!(c&&m&&Number.parseFloat(c)>0&&Number.parseFloat(m)>0),hasAddress:!!F,hasContractAddress:!!B.contracts.worm}),x(null)})(),()=>{e.abort()}},[c,m,F,T,B.contracts.worm]),(0,y.useEffect)(()=>{(async()=>{if(F&&B.contracts.beth&&B.contracts.worm&&M>0)try{let e=await _("allowance",[F,B.contracts.worm]),t=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n=e>=t/BigInt(2),r=BigInt(Math.floor(1e18*M));v(!n&&e<r)}catch(e){console.error("[v0] Error checking allowance:",e),v(!0)}else v(!1)})()},[F,B.contracts.beth,B.contracts.worm,M,_]);let P=async()=>{if(F&&B.contracts.worm){k(!0);try{let e=BigInt("1000000000000000000000000");console.log("[v0] Approving large BETH spend:",{spender:B.contracts.worm,amount:e.toString()});let t=await I("approve",[B.contracts.worm,e]);console.log("[v0] Approval transaction sent:",t.hash),await t.wait(),console.log("[v0] Approval transaction confirmed"),v(!1)}catch(e){console.error("[v0] Approval error:",e)}finally{k(!1)}}},Z=async()=>{if(R&&!b){p(!0);try{console.log("[v0] Participating:",{numEpochs:c,bethPerEpoch:m,totalBeth:M});let e=BigInt(Math.floor(1e18*(Number.parseFloat(m)||0))),t=BigInt(Number.parseInt(c)||0);console.log("[v0] Calling participate with:",{amountPerEpoch:e.toString(),numEpochs:t.toString()});let n=await A("participate",[e,t]);console.log("[v0] Participate transaction sent:",n.hash),await n.wait(),console.log("[v0] Participate transaction confirmed"),l(!1),d(""),u("")}catch(e){console.error("[v0] Participate error:",e)}finally{p(!1)}}};return(0,r.jsxs)(w.Vq,{open:s,onOpenChange:l,children:[(0,r.jsx)(w.hg,{asChild:!0,children:t}),(0,r.jsxs)(w.cZ,{className:"bg-green-950/95 border-green-800 text-white",children:[(0,r.jsx)(w.fK,{children:(0,r.jsx)(w.$N,{className:"text-green-300",children:"Participate in Mining"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"numEpochs",className:"text-green-300",children:"Number of Epochs"}),(0,r.jsx)(N.I,{id:"numEpochs",type:"number",value:c,onChange:e=>d(e.target.value),className:"bg-green-950/60 border-green-700 text-white",placeholder:"Enter number of epochs"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"bethPerEpoch",className:"text-green-300",children:"BETH per Epoch"}),(0,r.jsx)(N.I,{id:"bethPerEpoch",type:"number",step:"0.0001",value:m,onChange:e=>u(e.target.value),className:"bg-green-950/60 border-green-700 text-white",placeholder:"Enter BETH amount per epoch"})]}),(0,r.jsxs)("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(E.Z,{className:"w-4 h-4 text-green-400"}),(0,r.jsx)("span",{className:"text-green-300 font-medium",children:"Total BETH Required"})]}),(0,r.jsxs)("div",{className:"text-2xl font-mono text-yellow-300",children:[M.toFixed(4)," BETH"]}),(0,r.jsxs)("div",{className:"text-sm text-gray-400",children:["Your Balance: ",n," BETH"]}),!O&&M>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-red-400",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-sm",children:"Insufficient BETH balance"})]})]}),c&&m&&Number.parseFloat(c)>0&&Number.parseFloat(m)>0&&(0,r.jsxs)("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(E.Z,{className:"w-4 h-4 text-green-400"}),(0,r.jsx)("span",{className:"text-green-300 font-medium",children:"Approximate WORM Reward"})]}),(0,r.jsxs)("div",{className:"text-2xl font-mono text-yellow-300",children:[h?(Number(h)/1e18).toFixed(4):"Calculating..."," WORM"]}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"Estimated based on current conditions"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(o.z,{variant:"outline",onClick:()=>l(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800",children:"Cancel"}),b?(0,r.jsx)(o.z,{onClick:P,disabled:!R||!O||C,className:"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-semibold",children:C?"Approving...":"Approve BETH"}):(0,r.jsx)(o.z,{onClick:Z,disabled:!R||!O||g,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:g?"Participating...":"Participate"})]})]})]})]})}function k(e){let{children:t,currentEpoch:n}=e,[a,s]=(0,y.useState)(!1),[l,c]=(0,y.useState)(""),[d,m]=(0,y.useState)(""),[u,g]=(0,y.useState)(!1),[p,h]=(0,y.useState)(null),{address:x}=(0,S.K)(),{networkConfig:b}=(0,f.L)(),{readContract:v,writeContract:C}=(0,S.c)(b.contracts.worm,[{name:"calculateMintAmount",type:"function",stateMutability:"view",inputs:[{name:"_startingEpoch",type:"uint256"},{name:"_numEpochs",type:"uint256"},{name:"_user",type:"address"}],outputs:[{name:"",type:"uint256"}]},{name:"claim",type:"function",stateMutability:"nonpayable",inputs:[{name:"_startingEpoch",type:"uint256"},{name:"_numEpochs",type:"uint256"}],outputs:[{name:"",type:"uint256"}]}]),k=Number.parseInt(l)||0,F=Number.parseInt(d)||0,B=k+F-1,T=k<n&&B<n,A=l&&d&&T;(0,y.useEffect)(()=>{(async()=>{if(A&&x&&b.contracts.worm)try{console.log("[v0] Calling calculateMintAmount with:",{startingEpoch:k,numEpochs:F,userAddress:x,contractAddress:b.contracts.worm});let e=await v("calculateMintAmount",[BigInt(k),BigInt(F),x]);console.log("[v0] calculateMintAmount result:",e),h(e)}catch(e){console.error("[v0] Error fetching expected WORM amount:",e),h(null)}else console.log("[v0] Not fetching amount - conditions not met:",{isValid:A,hasAddress:!!x,hasContractAddress:!!b.contracts.worm}),h(null)})()},[A,x,k,F,v,b.contracts.worm]);let _=async()=>{if(A){g(!0);try{console.log("[v0] Claiming:",{fromEpoch:l,numEpochs:d});let e=BigInt(k),t=BigInt(F);console.log("[v0] Calling claim with:",{startingEpoch:e.toString(),numEpochs:t.toString()});let n=await C("claim",[e,t]);console.log("[v0] Claim transaction sent:",n.hash),await n.wait(),console.log("[v0] Claim transaction confirmed"),s(!1),c(""),m("")}catch(e){console.error("[v0] Claim error:",e)}finally{g(!1)}}};return(0,r.jsxs)(w.Vq,{open:a,onOpenChange:s,children:[(0,r.jsx)(w.hg,{asChild:!0,children:t}),(0,r.jsxs)(w.cZ,{className:"bg-green-950/95 border-green-800 text-white",children:[(0,r.jsx)(w.fK,{children:(0,r.jsx)(w.$N,{className:"text-green-300",children:"Claim WORM Tokens"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"claimFromEpoch",className:"text-green-300",children:"From Epoch"}),(0,r.jsx)(N.I,{id:"claimFromEpoch",type:"number",value:l,onChange:e=>c(e.target.value),className:"bg-green-950/60 border-green-700 text-white",placeholder:"Enter starting epoch",max:n-1})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"claimNumEpochs",className:"text-green-300",children:"Number of Epochs"}),(0,r.jsx)(N.I,{id:"claimNumEpochs",type:"number",value:d,onChange:e=>m(e.target.value),className:"bg-green-950/60 border-green-700 text-white",placeholder:"Enter number of epochs to claim"})]}),l&&d&&!T&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-400",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4"}),(0,r.jsxs)("span",{className:"text-sm",children:["Can only claim completed epochs (current: ",n,", claiming: ",k,"-",B,")"]})]}),A&&null!==p&&(0,r.jsxs)("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(E.Z,{className:"w-4 h-4 text-green-400"}),(0,r.jsx)("span",{className:"text-green-300 font-medium",children:"Expected WORM Reward"})]}),(0,r.jsxs)("div",{className:"text-2xl font-mono text-yellow-300",children:[0n===p?"0.0000":(Number(p)/1e18).toFixed(4)," WORM"]}),(0,r.jsxs)("div",{className:"text-sm text-gray-400",children:["Claimable from epochs ",k," to ",B]}),0n===p&&(0,r.jsx)("div",{className:"text-sm text-orange-400 mt-2",children:"No WORM tokens available for these epochs. You may not have participated in mining during this period."})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(o.z,{variant:"outline",onClick:()=>s(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800",children:"Cancel"}),(0,r.jsx)(o.z,{onClick:_,disabled:!A||u,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:u?"Claiming...":"Claim"})]})]})]})]})}var F=n(535),B=n(4508);let T=(0,F.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),A=y.forwardRef((e,t)=>{let{className:n,variant:a,...s}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,B.cn)(T({variant:a}),n),...s})});A.displayName="Alert",y.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,B.cn)("mb-1 font-medium leading-none tracking-tight",n),...a})}).displayName="AlertTitle";let _=y.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,B.cn)("text-sm [&_p]:leading-relaxed",n),...a})});_.displayName="AlertDescription";var I=n(3911),M=n(875),O=n(2135),R=n(401);let P=I.fC;I.ZA;let Z=I.B4,H=y.forwardRef((e,t)=>{let{className:n,children:a,...s}=e;return(0,r.jsxs)(I.xz,{ref:t,className:(0,B.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...s,children:[a,(0,r.jsx)(I.JO,{asChild:!0,children:(0,r.jsx)(M.Z,{className:"h-4 w-4 opacity-50"})})]})});H.displayName=I.xz.displayName;let z=y.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(I.u_,{ref:t,className:(0,B.cn)("flex cursor-default items-center justify-center py-1",n),...a,children:(0,r.jsx)(O.Z,{className:"h-4 w-4"})})});z.displayName=I.u_.displayName;let G=y.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(I.$G,{ref:t,className:(0,B.cn)("flex cursor-default items-center justify-center py-1",n),...a,children:(0,r.jsx)(M.Z,{className:"h-4 w-4"})})});G.displayName=I.$G.displayName;let U=y.forwardRef((e,t)=>{let{className:n,children:a,position:s="popper",...o}=e;return(0,r.jsx)(I.h_,{children:(0,r.jsxs)(I.VY,{ref:t,className:(0,B.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:s,...o,children:[(0,r.jsx)(z,{}),(0,r.jsx)(I.l_,{className:(0,B.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(G,{})]})})});U.displayName=I.VY.displayName,y.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(I.__,{ref:t,className:(0,B.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",n),...a})}).displayName=I.__.displayName;let W=y.forwardRef((e,t)=>{let{className:n,children:a,...s}=e;return(0,r.jsxs)(I.ck,{ref:t,className:(0,B.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(I.wU,{children:(0,r.jsx)(R.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(I.eT,{children:a})]})});W.displayName=I.ck.displayName,y.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(I.Z0,{ref:t,className:(0,B.cn)("-mx-1 my-1 h-px bg-muted",n),...a})}).displayName=I.Z0.displayName;var q=n(1817),K=n(9397),J=n(4882),V=n(1662),L=n(1188),$=n(5),D=n(135),Y=n(1489),Q=n(5474),X=n(9868),ee=n(1758),et=n(1091);let en=BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617"),er=BigInt("0xba44186ee7876b8007d2482cd46cec2d115b780980a6b46f0363f983d892f7e"),ea=BigInt("0xba44186ee7876b8007d2482cd46cec2d115b780980a6b46f0363f983d892f7f");function es(e){var t,n;let{children:a,onBurnComplete:s}=e,{address:l,signer:i}=(0,x.O)(),{networkConfig:c}=(0,f.L)(),[u,g]=(0,y.useState)(!1),[p,h]=(0,y.useState)([]),[b,v]=(0,y.useState)(!1),[E,S]=(0,y.useState)(0),[C,k]=(0,y.useState)(null),[F,B]=(0,y.useState)(null),[T,I]=(0,y.useState)(null),[M,O]=(0,y.useState)(null),[R,z]=(0,y.useState)(new Set),[G,es]=(0,y.useState)(!1),[eo,el]=(0,y.useState)(""),[ei,ec]=(0,y.useState)(""),[ed,em]=(0,y.useState)(!1),[eu,eg]=(0,y.useState)(!1),[ep,eh]=(0,y.useState)(""),[ex,ef]=(0,y.useState)({stage:"confirm"}),[eb,ev]=(0,y.useState)("https://worm-miner-3.darkube.app/proof"),[ey,ew]=(0,y.useState)(""),[eN,ej]=(0,y.useState)(!1),[eE,eS]=(0,y.useState)(!1),[eC,ek]=(0,y.useState)(!1),[eF,eB]=(0,y.useState)("0"),[eT,eA]=(0,y.useState)("0"),[e_,eI]=(0,y.useState)(""),eM="burn-key-results-".concat(l),eO=e=>{try{l&&localStorage.setItem(eM,JSON.stringify(e))}catch(e){console.error("Failed to save to localStorage:",e)}},eR=()=>{try{if(!l)return[];let e=localStorage.getItem(eM);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load from localStorage:",e),[]}};(0,y.useEffect)(()=>{if(l&&u){let e=eR();e.length>0&&(h(e),S(Math.max(...e.map(e=>e.index))+1))}},[l,u]);let eP=async(e,t)=>{if(i){console.log("[v0] Fetching balance for address ".concat(e," at index ").concat(t)),z(e=>new Set(e).add(t));try{let n=i.provider,r=await n.getBalance(e),a=(0,V.dF)(r);console.log("[v0] Balance fetched: ".concat(a," ETH for address ").concat(e)),h(e=>e.map(e=>e.index===t?{...e,balance:a}:e));let s=p.map(e=>e.index===t?{...e,balance:a}:e);if(eO(s),Number.parseFloat(a)>0){console.log("[v0] Balance > 0, checking nullifier consumption for index ".concat(t));let e=p.find(e=>e.index===t);e?(console.log("[v0] Found result for index ".concat(t,", burn key: ").concat(e.burnKey)),await ez(e.burnKey,t)):console.log("[v0] No result found for index ".concat(t))}}catch(e){console.error("Failed to fetch balance:",e)}finally{z(e=>{let n=new Set(e);return n.delete(t),n})}}};function eZ(e,t){let n=e.toString(16).padStart(2*t,"0"),r=new Uint8Array(t);for(let e=0;e<t;e++)r[e]=Number.parseInt(n.substr(2*e,2),16);return r}async function eH(){if(!i)throw Error("Wallet not connected");if(null!==M)return M;let e=await i.signMessage("EIP-7503"),t=BigInt(L.P.from(e).s)%en;return O(t),t}let ez=async(e,t)=>{if(!(null==i?void 0:i.provider)){console.log("[v0] No signer or provider available for nullifier check");return}console.log("[v0] Checking nullifier consumption for burn key ".concat(e," at index ").concat(t)),h(e=>e.map(e=>e.index===t?{...e,checkingConsumption:!0}:e));try{let n=c.contracts.beth;if(!n){console.warn("[v0] BETH contract address not configured");return}console.log("[v0] Using BETH contract address: ".concat(n));let r=function(e){let t=BigInt(e);return BigInt((0,Y.h4)(["0x"+ea.toString(16),"0x"+t.toString(16)]))}(e),a=function(e){let t=new Uint8Array(32),n=new Uint8Array(32),r=e.toString(16).padStart(64,"0");for(let e=0;e<32;e++)t[e]=Number.parseInt(r.substr(2*e,2),16);n[31]=7;let a=new Uint8Array(64);return a.set(t,0),a.set(n,32),console.log(a),(0,D.w)(a)}(r);console.log("[v0] Nullifier: ".concat(r.toString())),console.log("[v0] Storage slot: ".concat(a));let s=await i.provider.getStorage(n,a);console.log(a);let o="0x0000000000000000000000000000000000000000000000000000000000000001"===s;console.log("[v0] Storage value: ".concat(s)),console.log("[v0] Is consumed: ".concat(o)),h(e=>{let n=e.map(e=>e.index===t?{...e,isConsumed:o,checkingConsumption:!1}:e);return eO(n),n})}catch(e){console.error("[v0] Error checking nullifier consumption:",e),h(e=>e.map(e=>e.index===t?{...e,checkingConsumption:!1}:e))}};async function eG(e,t,n,r){if(r>BigInt("10000000000000000000"))throw"Cannot burn more than 10 ETH!";v(!0),k(null);try{if(!i||!l)throw Error("Please connect your wallet first");let a=(0,$.VT)(["uint256","uint256","address"],[n,t,l]),s=Q.Gh((0,D.w)(a))>>BigInt(8),o=eZ(r,32),c=eZ(s,32),d=new TextEncoder().encode("EIP-7503"),m=(await eH()+BigInt(e)*BigInt(10)**BigInt(18))%en,u=0;for(;u<1e8;){m>=en&&(m=BigInt(0));let a=eZ(m,32),s=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=new Uint8Array(t.reduce((e,t)=>e+t.length,0)),a=0;for(let e of t)r.set(e,a),a+=e.length;return r}(a,o,c,d),i="0x"+Array.from(s).map(e=>e.toString(16).padStart(2,"0")).join("");if((0,D.w)(i).slice(2).slice(0,4)==="0".repeat(4)){let a=function(e,t,n,r,a){try{BigInt(t);let s="0x"+er.toString(16),o="0x"+e.toString(16),l="0x"+a.toString(16),i=(0,$.VT)(["uint256","uint256","address"],[r,n,t]),c="0x"+(Q.Gh((0,D.w)(i))>>BigInt(8)).toString(16),d=(0,Y.qw)([s,o,l,c]),m=eZ(BigInt(d),32).slice(0,20);return"0x"+Array.from(m).map(e=>e.toString(16).padStart(2,"0")).join("")}catch(e){throw console.error("Error deriving burn address:",e),Error("Failed to derive burn address")}}(m,l,t,n,r),s={index:e,burnKey:m.toString(),burnAddress:a,proverFee:t.toString(),broadcasterFee:n.toString(),revealAmount:r.toString()};h(t=>{let n=[...t.filter(t=>t.index!==e),s].sort((e,t)=>e.index-t.index);return eO(n),n}),setTimeout(()=>eP(a,e),100);return}m+=BigInt(1),++u%1e3==0&&await new Promise(e=>setTimeout(e,0))}throw Error("Could not find suitable burn key within ".concat(1e8," iterations for index ").concat(e))}catch(e){k(e instanceof Error?e.message:"An error occurred")}finally{v(!1)}}let eU=e=>{let t=p.find(t=>t.burnAddress===e),n=((null==t?void 0:t.balance)?Number.parseFloat(t.balance):0)>0;el(e),eh((null==t?void 0:t.burnKey)||""),eg(n),ef({stage:"confirm"}),es(!0),ec(n?"":(0,V.dF)((null==t?void 0:t.revealAmount)||"0")),B(null),I(null)},eW=async()=>{if(i&&ei&&eo){em(!0);try{let e=(0,V.fi)(ei),t=await i.sendTransaction({to:eo,value:e});await t.wait();let n=p.find(e=>e.burnAddress===eo);n&&setTimeout(()=>eP(eo,n.index),1e3),es(!1),ec(""),null==s||s()}catch(e){k(e instanceof Error?e.message:"Failed to burn ETH")}finally{em(!1)}}},eq=async()=>{ef({stage:"generate"}),B(null),I(null);let e=p.find(e=>e.burnAddress===eo),t=(null==e?void 0:e.balance)||"0",n=(0,V.dF)(null==e?void 0:e.proverFee),r=(0,V.dF)(null==e?void 0:e.broadcasterFee),a="sepolia";try{if(null==i?void 0:i.provider){let e=await i.provider.getNetwork().then(e=>e.chainId);console.log("[v0] Chain ID:",e),(31337n===e||1337n===e)&&(a="anvil")}}catch(e){console.error("[v0] Error detecting network:",e)}let s={amount:t,prover_fee:n,broadcaster_fee:r,spend:t,network:a,wallet_address:l,burn_key:ep},o=eN?ey:eb;console.log("[v0] Generating proof with endpoint: ".concat(o)),console.log("[v0] Generating proof with request:",JSON.stringify(s,null,2));try{var c;let e=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify(s)});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();if(console.log("[v0] Job response:",JSON.stringify(t,null,2)),null===(c=t.result)||void 0===c?void 0:c.job_id){let e=t.result.job_id,n="".concat(o,"/").concat(e);console.log("[v0] Starting to poll: ".concat(n));let r=async()=>{try{let e=await fetch(n,{method:"GET",headers:{Accept:"application/json"},mode:"cors"});if(e.ok){let t=await e.json();if(console.log("[v0] Poll response:",JSON.stringify(t,null,2)),"error"===t.status||"failed"===t.status){let e=t.message||t.error||"Unknown error";console.error("[v0] Job failed:",e),I(e),B("Proof generation failed: ".concat(e)),ef({stage:"confirm"});return}if("in_progress"===t.status||"pending"===t.status){console.log("[v0] Job in progress, continuing to poll..."),t.message&&I(t.message),setTimeout(r,5e3);return}if("completed"===t.status){console.log("[v0] Job completed, proof ready!"),ef({stage:"submit",proof:t.result}),I(null);return}console.log("[v0] Unknown status, continuing to poll..."),setTimeout(r,5e3)}else console.error("[v0] Poll request failed:",e.status),setTimeout(r,5e3)}catch(e){console.error("[v0] Polling error:",e),setTimeout(r,5e3)}};r()}else console.error("[v0] No job_id received in response"),B("Invalid response from proof endpoint - no job_id received"),ef({stage:"confirm"})}catch(e){console.error("[v0] Error calling proof endpoint:",e),B("Failed to request proof: ".concat(e instanceof Error?e.message:"Unknown error")),ef({stage:"confirm"})}},eK=async()=>{if(ef({stage:"submitting"}),B(null),console.log("[v0] Submitting proof:",JSON.stringify(ex.proof,null,2)),!i||!ex.proof){B("Missing signer or proof data");return}try{var e;let{proof:t,block_number:n,nullifier_u256:r,remaining_coin:a,wallet_address:s,reveal_amount:o,prover_fee:l,broadcaster_fee:d,prover:m}=ex.proof,u=[t.proof.pi_a[0],t.proof.pi_a[1]],g=[[t.proof.pi_b[0][1],t.proof.pi_b[0][0]],[t.proof.pi_b[1][1],t.proof.pi_b[1][0]]],p=[t.proof.pi_c[0],t.proof.pi_c[1]],h=BigInt(n),x=BigInt(r),f=BigInt(a),b=BigInt(o),v=BigInt(l),y=BigInt(d);console.log("[v0] Calling mintCoin with parameters:",{_pA:u,_pB:g,_pC:p,_blockNumber:h.toString(),_nullifier:x.toString(),_remainingCoin:f.toString(),_receiver:s,_revealAmount:b.toString(),_proverFee:v.toString(),_broadcasterFee:y.toString()});let w=c.contracts.beth;if(!w)throw Error("BETH contract address not configured for current network");let N=new X.CH(w,[{name:"mintCoin",type:"function",stateMutability:"nonpayable",inputs:[{name:"_pA",type:"uint256[2]"},{name:"_pB",type:"uint256[2][2]"},{name:"_pC",type:"uint256[2]"},{name:"_blockNumber",type:"uint256"},{name:"_nullifier",type:"uint256"},{name:"_remainingCoin",type:"uint256"},{name:"_broadcasterFee",type:"uint256"},{name:"_revealedAmount",type:"uint256"},{name:"_revealedAmountReceiver",type:"address"},{name:"_proverFee",type:"uint256"},{name:"_prover",type:"address"},{name:"_receiverPostMintHook",type:"bytes"},{name:"_broadcasterFeePostMintHook",type:"bytes"}],outputs:[]}],i);console.log([u,g,p,h,x,f,y,b,s,v,m]);et.R.defaultAbiCoder().encode(["address","uint256","bytes"],[c.contracts.poolv3,V.fi("0.003"),(e=V.fi("0.003"),new ee.vU(["function swap(address recipient, bool zeroForOne, int256 amountSpecified, uint160 sqrtPriceLimitX96, bytes data)"]).encodeFunctionData("swap",[s,!0,Q.Gh(e),0,"0x"]))]);let j=await N.mintCoin(u,g,p,h,x,f,y,b,s,v,m,"0x","0x");console.log("[v0] mintCoin transaction sent:",j.hash),await j.wait(),console.log("[v0] mintCoin transaction confirmed"),ef({stage:"complete"}),console.log("[v0] Proof submitted successfully, refreshing balances..."),setTimeout(()=>{eJ()},1e3),setTimeout(()=>{es(!1),ef({stage:"confirm"})},2e3)}catch(e){console.error("[v0] Error submitting proof:",e),B("Failed to submit proof: ".concat(e instanceof Error?e.message:"Unknown error")),ef({stage:"submit"})}},eJ=()=>{p.forEach(e=>{eP(e.burnAddress,e.index)})},eV=eE?p:p.filter(e=>!e.isConsumed||!e.balance||0===Number.parseFloat(e.balance));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(w.Vq,{open:u,onOpenChange:g,children:[(0,r.jsx)(w.hg,{asChild:!0,children:a}),(0,r.jsxs)(w.cZ,{className:"bg-green-950/95 border-green-800 text-white max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,r.jsxs)(w.fK,{children:[(0,r.jsxs)(w.$N,{className:"text-2xl text-green-300 flex items-center gap-2",children:[(0,r.jsx)(m.Z,{className:"w-6 h-6"}),"Burn Addresses"]}),(0,r.jsx)(w.Be,{className:"text-gray-400",children:"Manage your burn addresses for EIP-7503 transactions. Generate new addresses or use existing ones to burn ETH."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(o.z,{onClick:eJ,size:"sm",variant:"outline",className:"border-green-600 text-green-300 hover:bg-green-900/50 bg-transparent",disabled:R.size>0,children:[(0,r.jsx)(d.Z,{className:"w-4 h-4 mr-2 ".concat(R.size>0?"animate-spin":"")}),"Refresh Balances"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"showConsumed",checked:eE,onChange:e=>eS(e.target.checked),className:"rounded border-green-700 bg-green-950/60 text-green-600 focus:ring-green-600"}),(0,r.jsx)(j._,{htmlFor:"showConsumed",className:"text-white text-sm",children:"Show consumed burn-addresses"})]})]}),(0,r.jsx)(o.z,{onClick:()=>{ek(!0),eB("0"),eA("0"),eI(""),k(null)},disabled:b||!l,size:"sm",className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating #",E,"..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(K.Z,{className:"mr-2 h-4 w-4"}),"Generate Address #",E]})})]}),eV.length>0?(0,r.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:eV.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-950/40 border border-green-800 rounded-lg",children:[(0,r.jsxs)("span",{className:"text-sm font-medium min-w-[60px] text-green-300",children:["#",e.index]}),(0,r.jsx)("span",{className:"text-xs text-gray-300 flex-1 font-mono bg-black/30 px-2 py-1 rounded",children:e.burnAddress}),(0,r.jsxs)("span",{className:"text-xs text-gray-400 min-w-[120px]",children:["Balance:"," ",R.has(e.index)?(0,r.jsx)(q.Z,{className:"h-3 w-3 animate-spin inline text-green-400"}):e.balance?(0,r.jsxs)("span",{className:"text-green-300 font-medium",children:[Number.parseFloat(e.balance).toFixed(6)," ETH"]}):"Unknown"]}),(0,r.jsx)(o.z,{size:"sm",variant:"outline",onClick:()=>eU(e.burnAddress),disabled:e.balance&&Number.parseFloat(e.balance)>0&&e.isConsumed,className:"ml-2 border-green-600 text-green-300 hover:bg-green-900/50 bg-transparent ".concat(e.isConsumed?"opacity-50 cursor-not-allowed":""),children:e.balance&&Number.parseFloat(e.balance)>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(J.Z,{className:"h-3 w-3 mr-1 text-green-400"}),e.isConsumed?"Consumed":"Mint"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"h-3 w-3 mr-1 text-yellow-400"}),"Burn"]})})]},e.index))}):(0,r.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,r.jsx)(m.Z,{className:"w-12 h-12 mx-auto mb-4 text-green-600"}),0===p.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"No burn addresses generated yet."}),(0,r.jsx)("p",{className:"text-sm",children:'Click "Generate Address" to create your first burn address.'})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"No available burn addresses to show."}),(0,r.jsx)("p",{className:"text-sm",children:'Check "Show consumed burn-addresses" to see all addresses.'})]})]}),C&&(0,r.jsx)(A,{className:"bg-red-900/30 border-red-700",children:(0,r.jsx)(_,{className:"text-red-300",children:C})})]})]})]}),(0,r.jsx)(w.Vq,{open:eC,onOpenChange:ek,children:(0,r.jsxs)(w.cZ,{className:"bg-green-950/95 border-green-800 text-white",children:[(0,r.jsxs)(w.fK,{children:[(0,r.jsxs)(w.$N,{className:"text-green-300",children:["Generate Burn Address #",E]}),(0,r.jsx)(w.Be,{className:"text-gray-400",children:"Configure the parameters for your new burn address. The reveal amount will be equal to the burn amount."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"burnAmount",className:"text-white",children:"Burn Amount (ETH) *"}),(0,r.jsx)(N.I,{id:"burnAmount",type:"number",placeholder:"0.0",value:e_,onChange:e=>eI(e.target.value),min:"0",step:"0.001",className:"bg-green-950/60 border-green-700 text-white placeholder:text-gray-400"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"This will also be the reveal amount"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"broadcasterFee",className:"text-white",children:"Broadcaster Fee (ETH)"}),(0,r.jsx)(N.I,{id:"broadcasterFee",type:"number",placeholder:"0.0",value:eF,onChange:e=>eB(e.target.value),min:"0",step:"0.001",className:"bg-green-950/60 border-green-700 text-white placeholder:text-gray-400"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"proverFee",className:"text-white",children:"Prover Fee (ETH)"}),(0,r.jsx)(N.I,{id:"proverFee",type:"number",placeholder:"0.0",value:eT,onChange:e=>eA(e.target.value),min:"0",step:"0.001",className:"bg-green-950/60 border-green-700 text-white placeholder:text-gray-400"})]}),C&&(0,r.jsx)(A,{className:"bg-red-900/30 border-red-700",children:(0,r.jsx)(_,{className:"text-red-300",children:C})}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(o.z,{variant:"outline",onClick:()=>ek(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800 bg-transparent",children:"Cancel"}),(0,r.jsxs)(o.z,{onClick:()=>{if(!e_||0>=Number.parseFloat(e_)){k("Please enter a valid burn amount");return}let e=(0,V.fi)(eT||"0"),t=(0,V.fi)(eF||"0"),n=(0,V.fi)(e_);ek(!1),eG(E,e,t,n),S(e=>e+1)},disabled:!e_||0>=Number.parseFloat(e_),className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:[(0,r.jsx)(K.Z,{className:"mr-2 h-4 w-4"}),"Generate"]})]})]})]})}),(0,r.jsx)(w.Vq,{open:G,onOpenChange:es,children:(0,r.jsxs)(w.cZ,{className:"bg-green-950/95 border-green-800 text-white",children:[(0,r.jsxs)(w.fK,{children:[(0,r.jsx)(w.$N,{className:"text-green-300",children:eu?"Mint BETH":"Burn ETH"}),(0,r.jsx)(w.Be,{className:"text-gray-400",children:eu?(0,r.jsxs)(r.Fragment,{children:["confirm"===ex.stage&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("strong",{children:[(null===(t=p.find(e=>e.burnAddress===eo))||void 0===t?void 0:t.balance)||"0"," BETH"]})," ","is going to be minted for address ",(0,r.jsx)("strong",{children:l})]}),"generate"===ex.stage&&(T||"Generating cryptographic proof..."),"submit"===ex.stage&&"Proof generated successfully. Ready to submit.","complete"===ex.stage&&"BETH minted successfully!"]}):"Send ETH to the burn address: ".concat(eo)})]}),eu?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(A,{className:"bg-yellow-900/30 border-yellow-600",children:(0,r.jsxs)(_,{className:"text-yellow-200",children:[(0,r.jsx)("strong",{children:"Privacy Notice:"})," If you want to use the privacy aspects of this protocol, it's mandatory to broadcast the proof submission transaction through a different wallet. If you just want to get BETH for WORM mining, using the same wallet is okay."]})}),F&&(0,r.jsx)(A,{className:"bg-red-900/30 border-red-700",children:(0,r.jsx)(_,{className:"text-red-300",children:F})}),"generate"===ex.stage&&T&&(0,r.jsx)("div",{className:"p-4 border-2 rounded-lg shadow-lg ".concat(F?"bg-gradient-to-r from-red-900/40 to-red-800/40 border-red-500/50":"bg-gradient-to-r from-blue-900/40 to-purple-900/40 border-blue-500/50"),children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:F?(0,r.jsx)("div",{className:"h-5 w-5 rounded-full bg-red-500 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-xs font-bold",children:"!"})}):(0,r.jsx)(q.Z,{className:"h-5 w-5 animate-spin text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-1 ".concat(F?"text-red-200":"text-blue-200"),children:F?"Proof Generation Error":"Proof Generation Status"}),(0,r.jsx)("p",{className:"text-white font-semibold",children:T})]})]})}),(0,r.jsxs)("div",{className:"p-4 bg-green-950/40 border border-green-800 rounded-lg",children:[(0,r.jsxs)("p",{className:"text-sm text-white",children:[(0,r.jsx)("strong",{children:"Burn Address:"})," ",(0,r.jsx)("span",{className:"font-mono text-xs",children:eo})]}),(0,r.jsxs)("p",{className:"text-sm text-white",children:[(0,r.jsx)("strong",{children:"Available Balance:"})," ",(0,r.jsxs)("span",{className:"text-green-300 font-medium",children:[(null===(n=p.find(e=>e.burnAddress===eo))||void 0===n?void 0:n.balance)||"0"," ETH"]})]})]}),"confirm"===ex.stage&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j._,{htmlFor:"endpoint",className:"text-white",children:"Proving Endpoint"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"useCustomEndpoint",checked:eN,onChange:e=>ej(e.target.checked),className:"rounded border-green-700 bg-green-950/60 text-green-600 focus:ring-green-600"}),(0,r.jsx)(j._,{htmlFor:"useCustomEndpoint",className:"text-white text-sm",children:"Use custom endpoint"})]}),eN?(0,r.jsx)(N.I,{type:"url",placeholder:"https://your-custom-endpoint.com/prove",value:ey,onChange:e=>ew(e.target.value),className:"bg-green-950/60 border-green-700 text-white placeholder:text-gray-400"}):(0,r.jsxs)(P,{value:eb,onValueChange:ev,children:[(0,r.jsx)(H,{className:"bg-green-950/60 border-green-700 text-white",children:(0,r.jsx)(Z,{placeholder:"Select proving endpoint"})}),(0,r.jsx)(U,{className:"bg-green-950 border-green-700",children:["https://worm-miner-3.darkube.app/proof","https://worm-testnet.metatarz.xyz/proof","http://localhost:8080/proof"].map(e=>(0,r.jsx)(W,{value:e,children:e},e))})]})]})}),"submit"===ex.stage&&(0,r.jsx)("div",{className:"p-3 bg-green-950/40 border border-green-800 rounded text-xs",children:(0,r.jsx)("strong",{className:"text-white",children:"Proof Generated!"})}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(o.z,{variant:"outline",onClick:()=>es(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800 bg-transparent",children:"Cancel"}),"confirm"===ex.stage&&(0,r.jsx)(o.z,{onClick:eq,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:"Generate proof"}),"generate"===ex.stage&&(0,r.jsxs)(o.z,{disabled:!0,className:"flex-1 bg-gray-600",children:[(0,r.jsx)(q.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating proof..."]}),"submit"===ex.stage&&(0,r.jsx)(o.z,{onClick:eK,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:"Submit proof"}),"submitting"===ex.stage&&(0,r.jsxs)(o.z,{disabled:!0,className:"flex-1 bg-gray-600",children:[(0,r.jsx)(q.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting proof..."]}),"complete"===ex.stage&&(0,r.jsxs)(o.z,{disabled:!0,className:"flex-1 bg-green-600",children:[(0,r.jsx)(J.Z,{className:"mr-2 h-4 w-4"}),"Minted successfully!"]})]})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"burnAmount",className:"text-white",children:"Amount (ETH)"}),(0,r.jsx)(N.I,{id:"burnAmount",type:"number",value:ei,readOnly:!0,className:"bg-green-950/60 border-green-700 text-white placeholder:text-gray-400 cursor-not-allowed"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"This is the predetermined burn amount for this address"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(o.z,{variant:"outline",onClick:()=>es(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800 bg-transparent",children:"Cancel"}),(0,r.jsx)(o.z,{onClick:eW,disabled:!ei||0>=Number.parseFloat(ei)||ed,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:ed?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Burning..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Burn ",ei," ETH"]})})]})]})]})})]})}function eo(){let{isConnected:e,address:t,connectWallet:n,disconnectWallet:w,error:N}=(0,x.O)(),{bethBalance:j,wormBalance:E,loading:S,error:F}=(0,v.l)(),{currentEpoch:B}=function(){let[e,t]=(0,y.useState)(0),[n,r]=(0,y.useState)(!0),[a,s]=(0,y.useState)(null),{networkConfig:o}=(0,f.L)(),l=async()=>{try{r(!0),s(null);let e=o.rpcUrls[0];console.log("[v0] Fetching current epoch from:",e),console.log("[v0] Using WORM contract:",o.contracts.worm);let n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"eth_call",params:[{to:o.contracts.worm,data:"0x76671808"},"latest"],id:1})}),a=await n.json();if(a.error)throw Error(a.error.message);let l=Number.parseInt(a.result,16);t(l),console.log("[v0] Current epoch:",l)}catch(e){console.error("[v0] Error fetching current epoch:",e),s(e instanceof Error?e.message:"Failed to fetch current epoch")}finally{r(!1)}};return(0,y.useEffect)(()=>{l();let e=setInterval(l,3e4);return()=>clearInterval(e)},[o]),{currentEpoch:e,loading:n,error:a,refetch:l}}();return(0,r.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,r.jsxs)("div",{className:"container mx-auto px-6 py-6 flex justify-between items-center",children:[(0,r.jsxs)(h.default,{href:"https://worm.cx",className:"inline-flex items-center gap-2 text-green-300 hover:text-green-200 transition-colors",children:[(0,r.jsx)(l.Z,{className:"w-4 h-4"}),"Back to Home"]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(b.m,{}),N&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-300 text-sm",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:N})]}),e?(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"text-sm font-mono text-green-300 bg-green-950/60 px-3 py-1 rounded-lg",children:"".concat(t.slice(0,6),"...").concat(t.slice(-4))}),(0,r.jsx)(o.z,{size:"sm",variant:"outline",onClick:w,className:"border-red-600 text-red-300 hover:bg-red-900/50 bg-transparent",children:"Disconnect"})]}):(0,r.jsxs)(o.z,{onClick:n,size:"sm",className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold border-0",children:[(0,r.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Connect Wallet"}),(0,r.jsx)("span",{className:"sm:hidden",children:"Connect"})]})]})]}),(0,r.jsx)("section",{className:"py-1 bg-green-950/10",children:(0,r.jsx)("div",{className:"container mx-auto px-6",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 transition-opacity duration-300 ".concat(e?"opacity-100":"opacity-50"),children:[(0,r.jsxs)(s.Zb,{className:"bg-green-950/40 border-green-800",children:[(0,r.jsxs)(s.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(s.ll,{className:"text-sm font-medium text-green-300",children:"BETH Balance"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[S&&(0,r.jsx)(d.Z,{className:"h-3 w-3 text-green-400 animate-spin"}),(0,r.jsx)(m.Z,{className:"h-4 w-4 text-yellow-400"})]})]}),(0,r.jsxs)(s.aY,{className:"space-y-3",children:[(0,r.jsx)("div",{className:"text-xl font-bold text-yellow-300 font-mono",children:e?S?"...":j:"---.----"}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"Burned ETH tokens"}),F&&(0,r.jsx)("p",{className:"text-xs text-red-400",children:"Error loading balance"}),(0,r.jsx)(es,{onBurnComplete:()=>{console.log("[v0] Burn completed, balances will refresh automatically")},children:(0,r.jsxs)(o.z,{size:"sm",variant:"outline",className:"border-green-600 text-green-300 hover:bg-green-900/50 bg-transparent w-full",children:["Burn ETH",(0,r.jsx)(m.Z,{className:"ml-2 w-4 h-4"})]})}),(0,r.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"Max 10 ETH per transaction"})]})]}),(0,r.jsxs)(s.Zb,{className:"bg-green-950/40 border-green-800",children:[(0,r.jsxs)(s.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(s.ll,{className:"text-sm font-medium text-green-300",children:"WORM Balance"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[S&&(0,r.jsx)(d.Z,{className:"h-3 w-3 text-green-400 animate-spin"}),(0,r.jsx)(u.Z,{className:"h-4 w-4 text-green-400"})]})]}),(0,r.jsxs)(s.aY,{className:"space-y-3",children:[(0,r.jsx)("div",{className:"text-xl font-bold text-green-300 font-mono",children:e?S?"...":E:"---.----"}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"Mined WORM tokens"}),F&&(0,r.jsx)("p",{className:"text-xs text-red-400",children:"Error loading balance"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)(C,{bethBalance:j,currentEpoch:B,children:(0,r.jsxs)(o.z,{size:"sm",variant:"outline",className:"border-blue-600 text-blue-300 hover:bg-blue-900/50 bg-transparent",disabled:!e,children:[(0,r.jsx)(g.Z,{className:"w-3 h-3 mr-1"}),"Participate"]})}),(0,r.jsx)(k,{currentEpoch:B,children:(0,r.jsxs)(o.z,{size:"sm",variant:"outline",className:"border-purple-600 text-purple-300 hover:bg-purple-900/50 bg-transparent",disabled:!e,children:[(0,r.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),"Claim"]})})]})]})]})]})})})}),(0,r.jsx)(a.BurnActivity,{})]})}function el(){return(0,r.jsx)(f.NetworkProvider,{children:(0,r.jsx)(x.n,{children:(0,r.jsx)(eo,{})})})}},2794:function(e,t,n){"use strict";n.d(t,{l:function(){return i}});var r=n(2265),a=n(9868),s=n(1662),o=n(2926),l=n(6366);function i(){let{isConnected:e,address:t,provider:n}=(0,o.O)(),{networkConfig:i}=(0,l.L)(),[c,d]=(0,r.useState)("0.0000"),[m,u]=(0,r.useState)("0.0000"),[g,p]=(0,r.useState)(!1),[h,x]=(0,r.useState)(null),[f,b]=(0,r.useState)(null),v=[{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],y=async()=>{if(!e||!t||!n){d("0.0000"),u("0.0000");return}f&&f.abort();let r=new AbortController;b(r);try{p(!0),x(null),console.log("[v0] Fetching balances for address:",t),console.log("[v0] Using BETH contract:",i.contracts.beth),console.log("[v0] Using WORM contract:",i.contracts.worm);let e=new a.CH(i.contracts.beth,v,n),o=new a.CH(i.contracts.worm,v,n),[l,c]=await Promise.all([n.getCode(i.contracts.beth),n.getCode(i.contracts.worm)]);"0x"===l&&(console.warn("[v0] BETH contract not found at address:",i.contracts.beth),d("0.0000")),"0x"===c&&(console.warn("[v0] WORM contract not found at address:",i.contracts.worm),u("0.0000"));let m=[],g=[];if("0x"!==l&&(m.push(e.balanceOf(t)),g.push("beth")),"0x"!==c&&(m.push(o.balanceOf(t)),g.push("worm")),0===m.length){console.warn("[v0] No valid contracts found on this network"),d("0.0000"),u("0.0000");return}let h=Promise.all(m),f=new Promise((e,t)=>{setTimeout(()=>t(Error("Request timeout")),1e4)}),b=new Promise((e,t)=>{r.signal.addEventListener("abort",()=>{t(Error("Request cancelled"))})}),y=await Promise.race([h,f,b]);if(r.signal.aborted)return;let w=BigInt(0),N=BigInt(0),j=0;g.includes("beth")&&(w=y[j],j++),g.includes("worm")&&(N=y[j]);let E=s.dF(w),S=s.dF(N);d(Number.parseFloat(E).toFixed(4)),u(Number.parseFloat(S).toFixed(4)),console.log("[v0] Balances fetched - BETH:",E,"WORM:",S)}catch(e){var o,l;(null===(o=e.message)||void 0===o?void 0:o.includes("network changed"))||"NETWORK_ERROR"===e.code?(console.log("[v0] Network change detected during balance fetch, will retry"),d("0.0000"),u("0.0000")):"Request cancelled"===e.message||"Request timeout"===e.message?console.log("[v0] Balance fetch cancelled or timed out"):("BAD_DATA"===e.code||(null===(l=e.message)||void 0===l?void 0:l.includes("could not decode result data"))?console.warn("[v0] Contract call failed - contracts may not exist on this network:",e.message):(console.error("[v0] Error fetching balances:",e),x(e.message||"Failed to fetch balances")),d("0.0000"),u("0.0000"))}finally{p(!1),b(null)}};return(0,r.useEffect)(()=>{y()},[e,t,n,i]),(0,r.useEffect)(()=>{if(e&&t){let e=setInterval(y,3e4);return()=>clearInterval(e)}},[e,t]),(0,r.useEffect)(()=>()=>{f&&f.abort()},[]),{bethBalance:c,wormBalance:m,loading:g,error:h}}},5684:function(e,t,n){"use strict";n.d(t,{K:function(){return o},c:function(){return l}});var r=n(2265),a=n(9146),s=n(9868);function o(){let[e,t]=(0,r.useState)(null),[n,s]=(0,r.useState)(null),[o,l]=(0,r.useState)(null),[i,c]=(0,r.useState)(!1),d=(0,r.useCallback)(async t=>{if(t.length>0){if(e)try{let n=await e.getSigner();s(n),l(t[0]),c(!0)}catch(e){console.error("Failed to get signer:",e)}}else l(null),s(null),c(!1)},[e]);(0,r.useEffect)(()=>{(async()=>{if(window.ethereum){let e=new a.Q(window.ethereum);t(e);try{if((await e.listAccounts()).length>0){let t=await e.getSigner();s(t),l(await t.getAddress()),c(!0)}}catch(e){console.error("Failed to get accounts:",e)}}})()},[]),(0,r.useEffect)(()=>{if(window.ethereum&&d)return window.ethereum.on("accountsChanged",d),()=>{window.ethereum.removeAllListeners("accountsChanged")}},[d]);let m=async()=>{if(e)try{await e.send("eth_requestAccounts",[]);let t=await e.getSigner();s(t),l(await t.getAddress()),c(!0)}catch(e){console.error("Failed to connect:",e)}};return{provider:e,signer:n,address:o,isConnected:i,connect:m}}function l(e,t){let{provider:n,signer:a}=o(),[l,i]=(0,r.useState)(null);(0,r.useEffect)(()=>{n&&e&&t&&i(new s.CH(e,t,a||n))},[n,a,e]);let c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!l)return null;try{return await l[e](...t)}catch(t){var n;if((null==t?void 0:t.code)==="NETWORK_ERROR"&&(null==t?void 0:null===(n=t.message)||void 0===n?void 0:n.includes("network changed")))return console.log("[v0] Network changed during ".concat(e," call, ignoring error")),null;return console.error("Error calling ".concat(e,":"),t),null}},d=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!l||!a)return null;try{let n;console.log("[v0] Attempting ".concat(e," with args:"),t);let r=await a.provider.getNetwork(),s=31337n===r.chainId||1337n===r.chainId;try{let r=await l[e].estimateGas(...t);console.log("[v0] Estimated gas for ".concat(e,":"),r.toString()),n=s?150n*r/100n:120n*r/100n,console.log("[v0] Using gas limit for ".concat(e,":"),n.toString())}catch(t){console.warn("[v0] Gas estimation failed for ".concat(e,":"),t),n=s?500000n:300000n,console.log("[v0] Using fallback gas limit for ".concat(e,":"),n.toString())}let o=await l[e](...t,{gasLimit:n});return console.log("[v0] ".concat(e," transaction sent:"),o.hash),o}catch(r){var n;if(console.error("[v0] Error calling ".concat(e,":"),r),(null==r?void 0:r.code)===-32603||(null==r?void 0:null===(n=r.message)||void 0===n?void 0:n.includes("Internal JSON-RPC error"))){console.log("[v0] RPC error calling ".concat(e,", trying alternative approach"));try{let n=await l[e](...t,{gasLimit:800000n,type:0});return console.log("[v0] Alternative approach succeeded:",n.hash),n}catch(n){console.error("[v0] Alternative approach also failed for ".concat(e,":"),n);try{console.log("[v0] Trying ".concat(e," with no gas options as final fallback"));let n=await l[e](...t);return console.log("[v0] No-gas-options approach succeeded:",n.hash),n}catch(t){throw console.error("[v0] All approaches failed for ".concat(e,":"),t),t}}}throw r}};return{contract:l,readContract:c,writeContract:d}}}},function(e){e.O(0,[978,620,438,843,900,971,117,744],function(){return e(e.s=6270)}),_N_E=e.O()}]);